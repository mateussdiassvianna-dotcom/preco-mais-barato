<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Criar Conta de Comerciante - Pre√ßo Mais Barato</title>
  <style>
    :root {
      --primary: #2563eb;
      --accent: #10b981;
      --bg: #f0f4f8;
      --card: #ffffff;
      --muted: #6b7280;
      --danger: #ef4444;
      --success: #10b981;
    }

    * { box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Roboto, Arial, sans-serif;
      margin: 0;
      padding: 28px;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      color: var(--primary);
      background: linear-gradient(180deg, #e6f0ff 0%, #f0f7f3 100%);
    }

    header {
      width: 100%;
      max-width: 900px;
      margin-bottom: 18px;
      animation: fadeInDown 700ms ease;
    }
    header h1 {
      margin: 0;
      font-size: 1.9rem;
      color: var(--primary);
      letter-spacing: 0.2px;
    }
    header p {
      margin: 6px 0 0;
      color: var(--muted);
    }

    main {
      background: var(--card);
      width: 100%;
      max-width: 720px;
      border-radius: 16px;
      padding: 28px;
      box-shadow: 0 12px 30px rgba(37,99,235,0.08), 0 4px 8px rgba(16,185,129,0.03);
      text-align: left;
      overflow: hidden;
      position: relative;
      animation: fadeInUp 700ms ease;
    }

    main .grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 18px;
    }

    @media (max-width: 720px) {
      main .grid { grid-template-columns: 1fr; }
    }

    label {
      display: block;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 6px;
      font-size: 14px;
    }

    .field {
      margin-bottom: 14px;
    }

    input[type="text"],
    input[type="email"],
    input[type="password"],
    input[type="tel"],
    select,
    textarea {
      width: 100%;
      padding: 12px 14px;
      border-radius: 10px;
      border: 1px solid #d1d5db;
      font-size: 14px;
      transition: box-shadow 0.18s ease, border-color 0.18s ease, transform 0.08s;
      background: #fff;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 6px 18px rgba(37,99,235,0.12);
      transform: translateY(-1px);
    }

    .input-group { position: relative; }

    .toggle-password {
      position: absolute;
      right: 10px;
      top: 50%;
      transform: translateY(-50%);
      cursor: pointer;
      font-size: 16px;
      color: var(--muted);
      user-select: none;
      padding: 6px;
      border-radius: 6px;
      transition: background 0.15s, color 0.15s;
    }
    .toggle-password:hover {
      background: rgba(37,99,235,0.06);
      color: var(--primary);
    }

    .file-preview {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 8px;
    }
    .file-preview img {
      width: 72px;
      height: 72px;
      object-fit: cover;
      border-radius: 10px;
      border: 1px solid #e6eef8;
      box-shadow: 0 6px 18px rgba(16,185,129,0.06);
    }

    .small-muted { font-size: 13px; color: var(--muted); margin-top: 6px; }

    .checkbox-row {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 6px;
    }

    .btn {
      display: inline-block;
      background: var(--primary);
      color: white;
      padding: 12px 18px;
      border-radius: 12px;
      border: none;
      font-weight: 700;
      cursor: pointer;
      font-size: 15px;
      box-shadow: 0 10px 25px rgba(37,99,235,0.12);
      transition: transform 0.12s ease, box-shadow 0.12s ease, background 0.12s;
      text-decoration: none;
      text-align: center;
    }
    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 16px 30px rgba(37,99,235,0.16);
    }
    .btn.secondary {
      background: var(--accent);
      box-shadow: 0 8px 20px rgba(16,185,129,0.12);
    }

    .geo-status { font-size: 13px; color: var(--muted); margin-top: 8px; display: block; }

    .actions {
      margin-top: 20px;
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
    }

    .note {
      background: #fffbeb;
      border: 1px solid #fef3c7;
      padding: 10px 12px;
      border-radius: 8px;
      color: #b45309;
      font-size: 14px;
      display: inline-block;
    }

    @keyframes fadeInDown { from { opacity:0; transform: translateY(-12px);} to { opacity:1; transform:none;} }
    @keyframes fadeInUp { from { opacity:0; transform: translateY(12px);} to { opacity:1; transform:none;} }

  </style>
</head>
<body>

<header>
  <h1>Criar Conta de Comerciante</h1>
  <p>Cadastre seu com√©rcio para aparecer nos resultados e receber pedidos pelo WhatsApp.</p>
</header>

<main>
  <form id="cadastroComerciante" method="POST" action="{{ url_for('comerciante.comerciante_cadastro') }}" enctype="multipart/form-data" novalidate>
    <div class="grid">
      <div>
        <div class="field">
          <label for="nome">Nome do Com√©rcio *</label>
          <input id="nome" name="nome" type="text" placeholder="Ex: Padaria Central" required>
        </div>

        <div class="field">
          <label for="email">E-mail *</label>
          <input id="email" name="email" type="email" placeholder="exemplo@dominio.com" required>
        </div>

        <div class="field">
          <label for="whatsapp">Telefone / WhatsApp *</label>
          <input id="whatsapp" name="whatsapp" type="tel" placeholder="Ex: (63) 9 8124-5663" required>
        </div>

        <div class="field input-group">
          <label for="senha">Senha *</label>
          <input id="senha" name="senha" type="password" placeholder="Crie uma senha segura" required>
          <span class="toggle-password" id="toggleSenha" title="Mostrar/ocultar senha">üëÅÔ∏è</span>
        </div>

        <div class="field">
          <label for="estado">Estado *</label>
          <select id="estado" name="estado" required>
            <option value="">Selecione o estado</option>
            <option value="TO">Tocantins</option>
            <option value="GO">Goi√°s</option>
            <option value="BA">Bahia</option>
            <option value="MA">Maranh√£o</option>
            <option value="PA">Par√°</option>
            <option value="MT">Mato Grosso</option>
            <option value="DF">Distrito Federal</option>
            <option value="MG">Minas Gerais</option>
            <option value="SP">S√£o Paulo</option>
            <option value="RJ">Rio de Janeiro</option>
          </select>
        </div>

        <div class="field">
          <label for="cidade">Cidade *</label>
          <select id="cidade" name="cidade" required>
            <option value="">Selecione primeiro o estado</option>
          </select>
        </div>
      </div>

      <div>
        <div class="field">
          <label for="endereco_logradouro">Endere√ßo *</label>
          <input id="endereco_logradouro" name="endereco_logradouro" type="text" placeholder="Ex: Rua das Flores" required>
        </div>

        <div class="field">
          <label for="endereco_numero">N√∫mero *</label>
          <input id="endereco_numero" name="endereco_numero" type="text" placeholder="Ex: 123" required>
        </div>

        <div class="field">
          <label for="endereco_complemento">Complemento</label>
          <input id="endereco_complemento" name="endereco_complemento" type="text" placeholder="Ex: Sala 1, Loja B">
        </div>

        <div class="field">
          <label for="foto_perfil">Foto do Com√©rcio</label>
          <input id="foto_perfil" name="foto_perfil" type="file" accept="image/*">
          <div class="file-preview" id="previewContainer" style="display:none">
            <img id="previewImage" src="#" alt="Preview">
            <div>
              <div style="font-weight:700; color:var(--primary)">Imagem selecionada</div>
              <div class="small-muted">Preview da foto que ser√° exibida no perfil do com√©rcio.</div>
            </div>
          </div>
        </div>

        <div class="field">
          <label>Op√ß√µes</label>
          <div class="checkbox-row">
            <input id="faz_entrega" name="faz_entrega" type="checkbox" value="1">
            <label for="faz_entrega" style="margin:0; font-weight:600; color:var(--muted)">Realiza entrega?</label>
          </div>
        </div>

        <div class="field">
          <label>Localiza√ß√£o do Com√©rcio (opcional)</label>
          <div style="display:flex; gap:10px; align-items:center; margin-top:6px;">
            <button type="button" id="pegarLocalizacao" class="btn secondary">Capturar Localiza√ß√£o</button>
            <span class="geo-status" id="localizacaoStatus">Se estiver no com√©rcio, marque sua posi√ß√£o. Se n√£o, pode deixar em branco e atualizar depois. Seus clientes v√£o conseguir te encontrar mais f√°cil e ver os produtos mais pr√≥ximos.</span>
          </div>
          <small class="small-muted">Coloque a localiza√ß√£o do seu com√©rcio para que os clientes vejam a dist√¢ncia exata at√© voc√™. Isso ajuda a aparecer nos filtros de proximidade e custo-benef√≠cio.</small>
          <input type="hidden" id="latitude" name="latitude">
          <input type="hidden" id="longitude" name="longitude">
        </div>
      </div>
    </div>

    <div class="actions">
      <button type="submit" class="btn">Concluir Cadastro</button>
      <a class="btn secund√°rio" href="{{ url_for('comerciante.comerciante_opcoes') }}">Voltar</a>
      <div style="margin-left:auto" class="note">Ap√≥s cadastro, a conta ficar√° pendente at√© aprova√ß√£o.</div>
    </div>
  </form>

  <div class="footer-links" style="margin-top:20px;">
    <small class="small-muted">Criado pela Viana Tecnologia ‚Äì Suporte via WhatsApp: (63) 9 8124-5663. Envie apenas mensagens.</small>
  </div>

  <div class="sidebar" style="margin-top:20px; font-size:14px; line-height:1.4;">
    <strong>Aten√ß√£o:</strong><br>
    Cadastre-se e comece a adicionar seus produtos agora mesmo, sem compromisso!<br>
    Mensalidade: <strong>R$ 24,99</strong> por m√™s.<br>
    O pagamento s√≥ ser√° solicitado ap√≥s entrarmos em contato, alguns dias depois do seu cadastro, garantindo que voc√™ possa experimentar a plataforma antes.
  </div>
</main>

<script>
  // toggle senha
  const toggle = document.getElementById('toggleSenha');
  const senha = document.getElementById('senha');
  toggle.addEventListener('click', ()=> {
    if(senha.type === 'password'){
      senha.type = 'text';
      toggle.textContent = 'üôà';
      toggle.title = 'Ocultar senha';
    } else {
      senha.type = 'password';
      toggle.textContent = 'üëÅÔ∏è';
      toggle.title = 'Mostrar senha';
    }
  });

  // preview imagem
  const input = document.getElementById('foto_perfil');
  const preview = document.getElementById('previewContainer');
  const img = document.getElementById('previewImage');
  input.addEventListener('change', (e)=> {
    const file = e.target.files && e.target.files[0];
    if(!file || !file.type.startsWith('image/')) {
      preview.style.display = 'none';
      return;
    }
    const reader = new FileReader();
    reader.onload = function(ev){
      img.src = ev.target.result;
      preview.style.display = 'flex';
    }
    reader.readAsDataURL(file);
  });

  // cidades por estado
  const cidadesPorEstado = { 
    "TO":[ "Palmas","Aragua√≠na","Gurupi","Porto Nacional","Para√≠so do Tocantins","Formoso do Araguaia"],
    "GO":["Goi√¢nia","An√°polis","Rio Verde"],
    "BA":["Salvador","Feira de Santana","Vit√≥ria da Conquista"],
    "MA":["S√£o Lu√≠s","Imperatriz","Timon"],
    "PA":["Bel√©m","Santar√©m","Marab√°"],
    "MT":["Cuiab√°","V√°rzea Grande","Rondon√≥polis"],
    "DF":["Bras√≠lia","Taguatinga","Ceil√¢ndia"],
    "MG":["Belo Horizonte","Uberl√¢ndia","Contagem"],
    "SP":["S√£o Paulo","Campinas","Santos"],
    "RJ":["Rio de Janeiro","Niter√≥i","Petr√≥polis"]
  };
  const estadoSelect = document.getElementById("estado");
  const cidadeSelect = document.getElementById("cidade");
  estadoSelect.addEventListener("change", function(){
    const estado = this.value;
    cidadeSelect.innerHTML = "<option value=''>Selecione a cidade</option>";
    if(cidadesPorEstado[estado]){
      cidadesPorEstado[estado].forEach(cidade=>{
        const opt = document.createElement("option");
        opt.value = cidade;
        opt.textContent = cidade;
        cidadeSelect.appendChild(opt);
      });
    }
  });

  // geolocaliza√ß√£o
  const btnGeo = document.getElementById('pegarLocalizacao');
  const statusGeo = document.getElementById('localizacaoStatus');
  const latInput = document.getElementById('latitude');
  const lonInput = document.getElementById('longitude');
  btnGeo.addEventListener('click', ()=>{
    if(!navigator.geolocation){
      statusGeo.textContent = 'Geolocaliza√ß√£o n√£o suportada neste navegador.';
      return;
    }
    statusGeo.textContent = 'Detectando localiza√ß√£o...';
    btnGeo.disabled = true;
    navigator.geolocation.getCurrentPosition((pos)=>{
      latInput.value = pos.coords.latitude;
      lonInput.value = pos.coords.longitude;
      statusGeo.textContent = `Localiza√ß√£o capturada: ${pos.coords.latitude.toFixed(5)}, ${pos.coords.longitude.toFixed(5)}`;
      btnGeo.disabled = false;
    }, ()=>{
      statusGeo.textContent = 'N√£o foi poss√≠vel capturar a localiza√ß√£o. Tente novamente ou preencha manualmente.';
      btnGeo.disabled = false;
    }, { enableHighAccuracy:true, timeout:10000, maximumAge:60000 });
  });

  // valida√ß√£o simples antes de enviar
  const form = document.getElementById('cadastroComerciante');
  form.addEventListener('submit', (e)=>{
    const requiredFields = ["nome","email","estado","cidade"];
    let valid = true;
    requiredFields.forEach(id=>{
      const el = document.getElementById(id);
      if(!el.value.trim()) valid = false;
    });
    if(!valid){
      e.preventDefault();
      alert('Por favor preencha todos os campos obrigat√≥rios.');
      return false;
    }
    const submit = form.querySelector('button[type="submit"]');
    submit.disabled = true;
    submit.textContent = 'Enviando...';
  });
</script>

</body>
</html>
